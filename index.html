<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Multi OTP Sender</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(135deg, #667eea, #764ba2);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
  }

  .wrapper {
    display: flex;
    gap: 2rem;
    max-width: 900px;
    width: 100%;
  }

  .container {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    width: 460px;
    padding: 2.5rem 3rem;
    color: #333;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .container::before {
    content: "";
    position: absolute;
    top: -60px;
    right: -60px;
    width: 180px;
    height: 180px;
    background: #764ba2;
    border-radius: 50%;
    opacity: 0.15;
    z-index: 0;
  }

  .container::after {
    content: "";
    position: absolute;
    bottom: -80px;
    left: -80px;
    width: 220px;
    height: 220px;
    background: #667eea;
    border-radius: 50%;
    opacity: 0.15;
    z-index: 0;
  }

  h1 {
    text-align: center;
    margin-bottom: 2rem;
    font-weight: 600;
    font-size: 2rem;
    color: #4b3f72;
    position: relative;
    z-index: 1;
  }

  label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #5a4d7a;
    position: relative;
    z-index: 1;
  }

  input[type="text"],
  input[type="number"],
  select {
    width: 100%;
    padding: 0.75rem 1rem;
    margin-bottom: 1.5rem;
    border: 2px solid #d1c4e9;
    border-radius: 12px;
    font-size: 1rem;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    z-index: 1;
  }

  input[type="text"]:focus,
  input[type="number"]:focus,
  select:focus {
    border-color: #764ba2;
    box-shadow: 0 0 8px #764ba2aa;
    outline: none;
  }

  .button-group {
    display: flex;
    gap: 1rem;
    margin-top: auto;
  }

  button {
    flex: 1;
    padding: 0.85rem 0;
    background: linear-gradient(90deg, #667eea, #764ba2);
    border: none;
    border-radius: 14px;
    color: white;
    font-weight: 700;
    font-size: 1.2rem;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(118,75,162,0.4);
    transition: background 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    z-index: 1;
  }

  button:hover:not(:disabled) {
    background: linear-gradient(90deg, #5a6de0, #6a3f9f);
    box-shadow: 0 12px 30px rgba(106,63,159,0.6);
  }

  button:disabled {
    background: #b3a7d9;
    cursor: not-allowed;
    box-shadow: none;
  }

  #message {
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    width: 400px;
    max-height: 600px;
    overflow-y: auto;
    padding: 1.5rem;
    font-size: 0.95rem;
    line-height: 1.4;
    color: #333;
  }

  .message.success {
    background-color: #d4edda;
    color: #155724;
    border: 1.5px solid #c3e6cb;
    padding: 0.5rem 1rem;
    margin-bottom: 0.5rem;
    border-radius: 8px;
  }

  .message.error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1.5px solid #f5c6cb;
    padding: 0.5rem 1rem;
    margin-bottom: 0.5rem;
    border-radius: 8px;
  }

  /* Scrollbar styling for message box */
  #message::-webkit-scrollbar {
    width: 8px;
  }
  #message::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }
  #message::-webkit-scrollbar-thumb {
    background: #764ba2;
    border-radius: 10px;
  }

  /* Responsive */
  @media (max-width: 900px) {
    .wrapper {
      flex-direction: column;
      align-items: center;
    }
    .container, #message {
      width: 100%;
      max-width: none;
    }
    #message {
      max-height: 300px;
      margin-top: 1.5rem;
    }
  }
</style>
</head>
<body>
  <div class="wrapper">
    <div class="container" role="main" aria-label="Multi OTP Sender Form">
      <h1>Multi OTP Sender</h1>
      <form id="otpForm" novalidate>
        <label for="phone">Phone Number (without country code)</label>
        <input
          type="text"
          id="phone"
          name="phone"
          placeholder="e.g. 0000000000"
          pattern="\d{10}"
          inputmode="numeric"
          autocomplete="tel"
          required
          aria-describedby="phoneHelp"
        />
        <span id="phoneHelp" class="sr-only">Enter a 10-digit phone number</span>

        <label for="apiSelect">Select OTP API</label>
        <select id="apiSelect" name="apiSelect" required aria-required="true" aria-describedby="apiHelp">
          <option value="" disabled selected>Select API</option>
          <option value="allen">Allen Live OTP API</option>
          <option value="penpencil">PenPencil OTP API</option>
          <option value="unacademy">Unacademy OTP API</option>
        </select>
        <span id="apiHelp" class="sr-only">Choose the OTP API to send the OTP</span>

        <label for="times">How many times?</label>
        <input
          type="number"
          id="times"
          name="times"
          min="1"
          max="10"
          value="1"
          required
          aria-describedby="timesHelp"
        />
        <span id="timesHelp" class="sr-only">Number of OTPs to send, between 1 and 10</span>

        <label for="delay">Delay (in seconds)</label>
        <input
          type="number"
          id="delay"
          name="delay"
          min="1"
          max="60"
          value="3"
          required
          aria-describedby="delayHelp"
        />
        <!-- Removed the delayHelp span below -->
        <!-- <span id="delayHelp" class="sr-only">Delay between OTP sends in seconds, between 1 and 60</span> -->

        <div class="button-group">
          <button type="button" id="startBtn">Start</button>
          <button type="button" id="stopBtn" disabled>Stop</button>
        </div>
      </form>
    </div>

    <div id="message" aria-live="polite" aria-atomic="true" tabindex="0" role="log" aria-label="OTP sending responses"></div>
  </div>

<script>
  const form = document.getElementById('otpForm');
  const messageDiv = document.getElementById('message');
  const startBtn = document.getElementById('startBtn');
  const stopBtn = document.getElementById('stopBtn');

  let sending = false;
  let currentAttempt = 0;
  let totalAttempts = 0;
  let delayMs = 0;
  let phone = '';
  let api = '';
  let timerId = null;

  startBtn.addEventListener('click', () => {
    if (sending) return;

    phone = form.phone.value.trim();
    api = form.apiSelect.value;
    totalAttempts = parseInt(form.times.value);
    delayMs = parseInt(form.delay.value) * 1000;

    // Validation
    if (!/^\d{10}$/.test(phone)) {
      showMessage('Please enter a valid 10-digit phone number.', 'error');
      return;
    }
    if (!api) {
      showMessage('Please select an OTP API.', 'error');
      return;
    }
    if (totalAttempts < 1 || totalAttempts > 10) {
      showMessage('Please enter a valid number of times (1-10).', 'error');
      return;
    }
    if (delayMs < 1000 || delayMs > 60000) {
      showMessage('Please enter a valid delay between 1 and 60 seconds.', 'error');
      return;
    }

    sending = true;
    currentAttempt = 0;
    messageDiv.innerHTML = '';
    startBtn.disabled = true;
    stopBtn.disabled = false;
    form.phone.disabled = true;
    form.apiSelect.disabled = true;
    form.times.disabled = true;
    form.delay.disabled = true;

    sendNextOtp();
  });

  stopBtn.addEventListener('click', () => {
    if (!sending) return;
    sending = false;
    clearTimeout(timerId);
    showMessage('Sending stopped by user.', 'error');
    startBtn.disabled = false;
    stopBtn.disabled = true;
    form.phone.disabled = false;
    form.apiSelect.disabled = false;
    form.times.disabled = false;
    form.delay.disabled = false;
  });

  async function sendNextOtp() {
    if (!sending) return;
    if (currentAttempt >= totalAttempts) {
      showMessage('All OTPs sent.', 'success');
      sending = false;
      startBtn.disabled = false;
      stopBtn.disabled = true;
      form.phone.disabled = false;
      form.apiSelect.disabled = false;
      form.times.disabled = false;
      form.delay.disabled = false;
      return;
    }
    currentAttempt++;
    try {
      if (api === 'allen') {
        await sendAllenOtp(phone, currentAttempt);
      } else if (api === 'penpencil') {
        await sendPenPencilOtp(phone, currentAttempt);
      } else if (api === 'unacademy') {
        await sendUnacademyOtp(phone, currentAttempt);
      }
    } catch (error) {
      showMessage(`Attempt ${currentAttempt}: Error - ${error.message}`, 'error');
    }
    if (!sending) return;
    timerId = setTimeout(sendNextOtp, delayMs);
  }

  function showMessage(msg, type) {
    const p = document.createElement("div");
    p.textContent = msg;
    p.className = type === "error" ? "message error" : "message success";
    messageDiv.appendChild(p);
    messageDiv.scrollTop = messageDiv.scrollHeight;
  }

  async function sendAllenOtp(phone, attempt) {
    const url = 'https://api.allen-live.in/api/v1/auth/sendOtp';
    const payload = { country_code: "91", phone_number: phone, persona_type: "STUDENT" };
    const headers = {
      'Content-Type': 'application/json',
      'x-device-id': '624a70b3-d577-430e-a63b-b67f28865a90',
      'x-client-type': 'web',
      'accept': 'application/json',
      'origin': 'https://allen.in'
    };

    const response = await fetch(url, { method: 'POST', headers, body: JSON.stringify(payload), mode: 'cors' });

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new Error(errorData.message || `Allen API failed at attempt ${attempt}`);
    }

    showMessage(`Attempt ${attempt}: OTP sent successfully via Allen Live API!`, 'success');
  }

  async function sendPenPencilOtp(phone, attempt) {
    const url = 'https://api.penpencil.co/v1/users/get-otp?smsType=0&fallback=true';
    const payload = { username: phone, countryCode: "+91", organizationId: "5eb393ee95fab7468a79d189" };
    const headers = {
      'Content-Type': 'application/json',
      'randomid': '037e210d-f29a-4b7e-9383-9c1efa4816ae',
      'accept': '*/*',
      'origin': 'https://www.pw.live'
    };

    const response = await fetch(url, { method: 'POST', headers, body: JSON.stringify(payload), mode: 'cors' });

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new Error(errorData.message || `PenPencil API failed at attempt ${attempt}`);
    }

    showMessage(`Attempt ${attempt}: OTP sent successfully via PenPencil API!`, 'success');
  }

  async function sendUnacademyOtp(phone, attempt) {
    const url = 'https://unacademy.com/api/v3/user/user_check/?enable-email=true';
    const payload = {
      phone: phone,
      country_code: "IN",
      otp_type: 1,
      email: "",
      send_otp: true,
      is_un_teach_user: false
    };
    const headers = {
      'Content-Type': 'application/json',
      'x-platform': '0',
      'accept': '*/*',
      'origin': 'https://unacademy.com',
      'referer': 'https://unacademy.com/'
    };

    const response = await fetch(url, { method: 'POST', headers, body: JSON.stringify(payload), mode: 'cors' });

    if (!response.ok) {
      const errorData = await response.json().catch(() => ({}));
      throw new Error(errorData.message || `Unacademy API failed at attempt ${attempt}`);
    }

    showMessage(`Attempt ${attempt}: OTP sent successfully via Unacademy API!`, 'success');
  }
</script>
</body>
</html>
``` ⬤